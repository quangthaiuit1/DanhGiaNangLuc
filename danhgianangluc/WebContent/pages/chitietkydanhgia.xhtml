<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:pe="http://primefaces.org/ui/extensions"
	xmlns:h="http://java.sun.com/jsf/html" template="/pages/home.xhtml">
	<ui:define name="content">
		<script>
	function setupTable(){
			$("span.wctb200").parents('th').css("width", "200");
			$("span.wctb50").parents('th').css("width", "50");
			$("span.wctb20").parents('th').css("width", "20");
			$("div.tacenter").parents('td').css("text-align", "center");
		}
	
	</script>
	<style>
		.w30px input{
			width: 30px;
		    color: #9705b0 !important;
		    text-align: center;
		    font-weight: bold !important;
		}	
	</style>
		<h3 style="margin: 0px; float: left">Kỳ đánh giá</h3>
		<div style="clear: both" />
		<p:separator />
		<h:form id="menuformid">
			<p:fieldset>
				<h:panelGrid columns="1" style="float:left">
					<p:panelGrid columns="2" columnClasses="w40,w60">
						<p:outputLabel value="Chọn phòng ban" />
						<p:selectOneMenu value="#{chiTietKyDanhGiaBean.department}"
							converter="abstractConverter" effect="fade" var="t"
							style="width:150px;" filter="true" filterMatchMode="custom"
							filterFunction="customFilter">
							<p:ajax listener="#{chiTietKyDanhGiaBean.ajaxDep()}"
								oncomplete="setupTable()" process="@this" update=":menuformid" />
							<f:selectItem itemLabel="--PHÒNG BAN--" itemValue="#{null}" />
							<f:selectItems value="#{chiTietKyDanhGiaBean.departments}"
								var="item" itemLabel="#{item.name}" itemValue="#{item}" />
							<p:column>
								<h:outputText value="#{t.code}" />
							</p:column>
							<p:column>
								<h:outputText value="#{t.showAllNameDepart()}" escape="false" />
							</p:column>
						</p:selectOneMenu>
					</p:panelGrid>
				</h:panelGrid>
				<h:panelGrid columns="1" style="float:right">
					<p:panelGrid>
						<p:commandButton styleClass="btsave" value="Lưu cài đặt"
							disabled="#{chiTietKyDanhGiaBean.chiTietKyDanhGiaTables.size()==0}"
							update=":messagesbar"
							action="#{chiTietKyDanhGiaBean.saveAndUpdate()}" />
					</p:panelGrid>
				</h:panelGrid>
				<div style="clear: both" />
			</p:fieldset>
			<p:dataTable value="#{chiTietKyDanhGiaBean.chiTietKyDanhGiaTables}"
				var="item" styleClass="tableformat" paginatorPosition="bottom"
				style="background: #c6e0f4;" rowsPerPageTemplate="80,100,120"
				paginator="true" rows="80" expandableRowGroups="true"
				sortBy="#{item.nangLuc.nhomNangLuc.ma}">
				<p:headerRow>
					<p:column style="background:#2196f338;text-align:center">
						<h:outputText value="" />
					</p:column>
					<p:column style="background:#2196f338;">
						<h:outputText value="#{item.nangLuc.nhomNangLuc.ten}" />
					</p:column>
					<p:column style="background:#2196f338;text-align:center"
						rendered="#{chiTietKyDanhGiaBean.columns.size()-2 gt 0}">
						<p:inputNumber minValue="1" maxlength="100" symbol="%" symbolPosition="s" decimalPlaces="0" styleClass="w30px"
							value="#{chiTietKyDanhGiaBean.trongsonhoms[item.nangLuc.nhomNangLuc.id-1][0]}">
							<p:ajax event="blur" process="@this" />
						</p:inputNumber>
					</p:column>
					<p:column style="background:#2196f338;text-align:center"
						rendered="#{chiTietKyDanhGiaBean.columns.size()-3 gt 0}">
						<p:inputNumber minValue="1" maxlength="100" symbol="%" symbolPosition="s" decimalPlaces="0" styleClass="w30px"
							value="#{chiTietKyDanhGiaBean.trongsonhoms[item.nangLuc.nhomNangLuc.id-1][1]}">
							<p:ajax event="blur" process="@this" />
						</p:inputNumber>
					</p:column>
					<p:column style="background:#2196f338;text-align:center"
						rendered="#{chiTietKyDanhGiaBean.columns.size()-4 gt 0}">
						<p:inputNumber minValue="1" maxlength="100" symbol="%" symbolPosition="s" decimalPlaces="0" styleClass="w30px"
							value="#{chiTietKyDanhGiaBean.trongsonhoms[item.nangLuc.nhomNangLuc.id-1][2]}">
							<p:ajax event="blur" process="@this" />
						</p:inputNumber>
					</p:column>
					<p:column style="background:#2196f338;text-align:center"
						rendered="#{chiTietKyDanhGiaBean.columns.size()-5 gt 0}">
						<p:inputNumber minValue="1" maxlength="100" symbol="%" symbolPosition="s" decimalPlaces="0" styleClass="w30px"
							value="#{chiTietKyDanhGiaBean.trongsonhoms[item.nangLuc.nhomNangLuc.id-1][3]}">
							<p:ajax event="blur" process="@this" />
						</p:inputNumber>
					</p:column>
					<p:column style="background:#2196f338;text-align:center"
						rendered="#{chiTietKyDanhGiaBean.columns.size()-6 gt 0}">
						<p:inputNumber minValue="1" maxlength="100" symbol="%" symbolPosition="s" decimalPlaces="0" styleClass="w30px"
							value="#{chiTietKyDanhGiaBean.trongsonhoms[item.nangLuc.nhomNangLuc.id-1][4]}">
							<p:ajax event="blur" process="@this" />
						</p:inputNumber>
					</p:column>
					<p:column style="background:#2196f338;text-align:center"
						rendered="#{chiTietKyDanhGiaBean.columns.size()-7 gt 0}">
						<p:inputNumber minValue="1" maxlength="100" symbol="%" symbolPosition="s" decimalPlaces="0" styleClass="w30px"
							value="#{chiTietKyDanhGiaBean.trongsonhoms[item.nangLuc.nhomNangLuc.id-1][5]}">
							<p:ajax event="blur" process="@this" />
						</p:inputNumber>
					</p:column>
					<p:column style="background:#2196f338;text-align:center"
						rendered="#{chiTietKyDanhGiaBean.columns.size()-8 gt 0}">
						<p:inputNumber minValue="1" maxlength="100" symbol="%" symbolPosition="s" decimalPlaces="0" styleClass="w30px"
							value="#{chiTietKyDanhGiaBean.trongsonhoms[item.nangLuc.nhomNangLuc.id-1][6]}">
							<p:ajax event="blur" process="@this" />
						</p:inputNumber>
					</p:column>
					<p:column style="background:#2196f338;text-align:center"
						rendered="#{chiTietKyDanhGiaBean.columns.size()-9 gt 0}">
						<p:inputNumber minValue="1" maxlength="100" symbol="%" symbolPosition="s" decimalPlaces="0" styleClass="w30px"
							value="#{chiTietKyDanhGiaBean.trongsonhoms[item.nangLuc.nhomNangLuc.id-1][7]}">
							<p:ajax event="blur" process="@this" />
						</p:inputNumber>
					</p:column>
					<p:column style="background:#2196f338;text-align:center"
						rendered="#{chiTietKyDanhGiaBean.columns.size()-10 gt 0}">
						<p:inputNumber minValue="1" maxlength="100" symbol="%" symbolPosition="s" decimalPlaces="0" styleClass="w30px"
							value="#{chiTietKyDanhGiaBean.trongsonhoms[item.nangLuc.nhomNangLuc.id-1][8]}">
							<p:ajax event="blur" process="@this" />
						</p:inputNumber>
					</p:column>
					<p:column style="background:#2196f338;text-align:center"
						rendered="#{chiTietKyDanhGiaBean.columns.size()-11 gt 0}">
						<p:inputNumber minValue="1" maxlength="100" symbol="%" symbolPosition="s" decimalPlaces="0" styleClass="w30px"
							value="#{chiTietKyDanhGiaBean.trongsonhoms[item.nangLuc.nhomNangLuc.id-1][9]}">
							<p:ajax event="blur" process="@this" />
						</p:inputNumber>
					</p:column>
					<p:column style="background:#2196f338;text-align:center"
						rendered="#{chiTietKyDanhGiaBean.columns.size()-12 gt 0}">
						<p:inputNumber minValue="1" maxlength="100" symbol="%" symbolPosition="s" decimalPlaces="0" styleClass="w30px"
							value="#{chiTietKyDanhGiaBean.trongsonhoms[item.nangLuc.nhomNangLuc.id-1][10]}">
							<p:ajax event="blur" process="@this" />
						</p:inputNumber>
					</p:column>
					<p:column style="background:#2196f338;text-align:center"
						rendered="#{chiTietKyDanhGiaBean.columns.size()-13 gt 0}">
						<p:inputNumber minValue="1" maxlength="100" symbol="%" symbolPosition="s" decimalPlaces="0" styleClass="w30px"
							value="#{chiTietKyDanhGiaBean.trongsonhoms[item.nangLuc.nhomNangLuc.id-1][11]}">
							<p:ajax event="blur" process="@this" />
						</p:inputNumber>
					</p:column>
					<p:column style="background:#2196f338;text-align:center"
						rendered="#{chiTietKyDanhGiaBean.columns.size()-14 gt 0}">
						<p:inputNumber minValue="1" maxlength="100" symbol="%" symbolPosition="s" decimalPlaces="0" styleClass="w30px"
							value="#{chiTietKyDanhGiaBean.trongsonhoms[item.nangLuc.nhomNangLuc.id-1][12]}">
							<p:ajax event="blur" process="@this" />
						</p:inputNumber>
					</p:column>
					<p:column style="background:#2196f338;text-align:center"
						rendered="#{chiTietKyDanhGiaBean.columns.size()-15 gt 0}">
						<p:inputNumber minValue="1" maxlength="100" symbol="%" symbolPosition="s" decimalPlaces="0" styleClass="w30px"
							value="#{chiTietKyDanhGiaBean.trongsonhoms[item.nangLuc.nhomNangLuc.id-1][13]}">
							<p:ajax event="blur" process="@this" />
						</p:inputNumber>
					</p:column>
					<p:column style="background:#2196f338;text-align:center"
						rendered="#{chiTietKyDanhGiaBean.columns.size()-16 gt 0}">
						<p:inputNumber minValue="1" maxlength="100" symbol="%" symbolPosition="s" decimalPlaces="0" styleClass="w30px"
							value="#{chiTietKyDanhGiaBean.trongsonhoms[item.nangLuc.nhomNangLuc.id-1][14]}">
							<p:ajax event="blur" process="@this" />
						</p:inputNumber>
					</p:column>
					<p:column style="background:#2196f338;text-align:center"
						rendered="#{chiTietKyDanhGiaBean.columns.size()-17 gt 0}">
						<p:inputNumber minValue="1" maxlength="100" symbol="%" symbolPosition="s" decimalPlaces="0" styleClass="w30px"
							value="#{chiTietKyDanhGiaBean.trongsonhoms[item.nangLuc.nhomNangLuc.id-1][15]}">
							<p:ajax event="blur" process="@this" />
						</p:inputNumber>
					</p:column>
					<p:column style="background:#2196f338;text-align:center"
						rendered="#{chiTietKyDanhGiaBean.columns.size()-18 gt 0}">
						<p:inputNumber minValue="1" maxlength="100" symbol="%" symbolPosition="s" decimalPlaces="0" styleClass="w30px"
							value="#{chiTietKyDanhGiaBean.trongsonhoms[item.nangLuc.nhomNangLuc.id-1][16]}">
							<p:ajax event="blur" process="@this" />
						</p:inputNumber>
					</p:column>
					<p:column style="background:#2196f338;text-align:center"
						rendered="#{chiTietKyDanhGiaBean.columns.size()-19 gt 0}">
						<p:inputNumber minValue="1" maxlength="100" symbol="%" symbolPosition="s" decimalPlaces="0" styleClass="w30px"
							value="#{chiTietKyDanhGiaBean.trongsonhoms[item.nangLuc.nhomNangLuc.id-1][17]}">
							<p:ajax event="blur" process="@this" />
						</p:inputNumber>
					</p:column>

					<p:column style="background:#2196f338;text-align:center"
						rendered="#{chiTietKyDanhGiaBean.columns.size()-20 gt 0}">
						<p:inputNumber minValue="1" maxlength="100" symbol="%" symbolPosition="s" decimalPlaces="0" styleClass="w30px"
							value="#{chiTietKyDanhGiaBean.trongsonhoms[item.nangLuc.nhomNangLuc.id-1][18]}">
							<p:ajax event="blur" process="@this" />
						</p:inputNumber>
					</p:column>
					<p:column style="background:#2196f338;text-align:center"
						rendered="#{chiTietKyDanhGiaBean.columns.size()-21 gt 0}">
						<p:inputNumber minValue="1" maxlength="100" symbol="%" symbolPosition="s" decimalPlaces="0" styleClass="w30px"
							value="#{chiTietKyDanhGiaBean.trongsonhoms[item.nangLuc.nhomNangLuc.id-1][19]}">
							<p:ajax event="blur" process="@this" />
						</p:inputNumber>
					</p:column>
					<p:column style="background:#2196f338;text-align:center"
						rendered="#{chiTietKyDanhGiaBean.columns.size()-22 gt 0}">
						<p:inputNumber minValue="1" maxlength="100" symbol="%" symbolPosition="s" decimalPlaces="0" styleClass="w30px"
							value="#{chiTietKyDanhGiaBean.trongsonhoms[item.nangLuc.nhomNangLuc.id-1][20]}">
							<p:ajax event="blur" process="@this" />
						</p:inputNumber>
					</p:column>
					<p:column style="background:#2196f338;text-align:center"
						rendered="#{chiTietKyDanhGiaBean.columns.size()-23 gt 0}">
						<p:inputNumber minValue="1" maxlength="100" symbol="%" symbolPosition="s" decimalPlaces="0" styleClass="w30px"
							value="#{chiTietKyDanhGiaBean.trongsonhoms[item.nangLuc.nhomNangLuc.id-1][21]}">
							<p:ajax event="blur" process="@this" />
						</p:inputNumber>
					</p:column>
					<p:column style="background:#2196f338;text-align:center"
						rendered="#{chiTietKyDanhGiaBean.columns.size()-24 gt 0}">
						<p:inputNumber minValue="1" maxlength="100" symbol="%" symbolPosition="s" decimalPlaces="0" styleClass="w30px"
							value="#{chiTietKyDanhGiaBean.trongsonhoms[item.nangLuc.nhomNangLuc.id-1][22]}">
							<p:ajax event="blur" process="@this" />
						</p:inputNumber>
					</p:column>
					<p:column style="background:#2196f338;text-align:center"
						rendered="#{chiTietKyDanhGiaBean.columns.size()-25 gt 0}">
						<p:inputNumber minValue="1" maxlength="100" symbol="%" symbolPosition="s" decimalPlaces="0" styleClass="w30px"
							value="#{chiTietKyDanhGiaBean.trongsonhoms[item.nangLuc.nhomNangLuc.id-1][23]}">
							<p:ajax event="blur" process="@this" />
						</p:inputNumber>
					</p:column>
					<p:column style="background:#2196f338;text-align:center"
						rendered="#{chiTietKyDanhGiaBean.columns.size()-26 gt 0}">
						<p:inputNumber minValue="1" maxlength="100" symbol="%" symbolPosition="s" decimalPlaces="0" styleClass="w30px"
							value="#{chiTietKyDanhGiaBean.trongsonhoms[item.nangLuc.nhomNangLuc.id-1][24]}">
							<p:ajax event="blur" process="@this" />
						</p:inputNumber>
					</p:column>
					<p:column style="background:#2196f338;text-align:center"
						rendered="#{chiTietKyDanhGiaBean.columns.size()-27 gt 0}">
						<p:inputNumber minValue="1" maxlength="100" symbol="%" symbolPosition="s" decimalPlaces="0" styleClass="w30px"
							value="#{chiTietKyDanhGiaBean.trongsonhoms[item.nangLuc.nhomNangLuc.id-1][25]}">
							<p:ajax event="blur" process="@this" />
						</p:inputNumber>
					</p:column>
					<p:column style="background:#2196f338;text-align:center"
						rendered="#{chiTietKyDanhGiaBean.columns.size()-28 gt 0}">
						<p:inputNumber minValue="1" maxlength="100" symbol="%" symbolPosition="s" decimalPlaces="0" styleClass="w30px"
							value="#{chiTietKyDanhGiaBean.trongsonhoms[item.nangLuc.nhomNangLuc.id-1][26]}">
							<p:ajax event="blur" process="@this" />
						</p:inputNumber>
					</p:column>
					<p:column style="background:#2196f338;text-align:center"
						rendered="#{chiTietKyDanhGiaBean.columns.size()-29 gt 0}">
						<p:inputNumber minValue="1" maxlength="100" symbol="%" symbolPosition="s" decimalPlaces="0" styleClass="w30px"
							value="#{chiTietKyDanhGiaBean.trongsonhoms[item.nangLuc.nhomNangLuc.id-1][27]}">
							<p:ajax event="blur" process="@this" />
						</p:inputNumber>
					</p:column>
					<p:column style="background:#2196f338;text-align:center"
						rendered="#{chiTietKyDanhGiaBean.columns.size()-30 gt 0}">
						<p:inputNumber minValue="1" maxlength="100" symbol="%" symbolPosition="s" decimalPlaces="0" styleClass="w30px"
							value="#{chiTietKyDanhGiaBean.trongsonhoms[item.nangLuc.nhomNangLuc.id-1][28]}">
							<p:ajax event="blur" process="@this" />
						</p:inputNumber>
					</p:column>
				</p:headerRow>
				<p:columns value="#{chiTietKyDanhGiaBean.columns}" var="column"
					columnIndexVar="colIndex">
					<f:facet name="header">
						<h:outputText value="#{column.header}"
							styleClass="#{column.style}" />
					</f:facet>
					<h:outputText rendered="#{column.property != 'danhgias'}"
						value="#{item[column.property]}" />
					<p:selectBooleanCheckbox styleClass="#{column.style}"
						rendered="#{column.property eq 'danhgias'}"
						value="#{item.danhgias[column.index].check}" />
				</p:columns>
			</p:dataTable>
		</h:form>
	</ui:define>
</ui:composition>